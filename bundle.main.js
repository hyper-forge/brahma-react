"use strict";var{createApp:w,registerRustHotpath:h}=require("brahma-firelight"),a=w(),i=require("path"),c=require("fs"),x=require("mime-types");function y(t,e=[]){return c.readdirSync(t).forEach(l=>{let o=i.join(t,l);c.statSync(o).isDirectory()?y(o,e):e.push(o)}),e}function E(t,e=""){let u=y(t),l=(e||"").replace(/\/+$/,"");u.forEach(o=>{let p=i.relative(t,o).split(i.sep).join("/"),n=(l+"/"+p).replace(/\/+/g,"/");n.startsWith("/")||(n="/"+n);let r=c.readFileSync(o),S=x.lookup(o)||"application/octet-stream",f=JSON.stringify({"Content-Type":S,"Content-Length":String(r.length),"Cache-Control":"public, max-age=3600"});h("GET",n,200,f,r,!1);let g=p.toLowerCase();if(g.endsWith("/index.html")||g==="index.html"){let s=n.replace(/index\.html$/i,"");s===""&&(s="/");let m=s.endsWith("/")&&s!=="/"?s.slice(0,-1):s+"/";h("GET",s,200,f,r,!1),m!==s&&h("GET",m,200,f,r,!1)}})}var d=i.join(process.cwd(),"dist");if(!c.existsSync(d))throw new Error("dist folder not found: "+d);E(d,"/");a.get("/hi",(t,e)=>e.json({msg:"Hello from Brahma"}));a.post("/echo",(t,e)=>e.json(t.body.toString("utf-8")||"{}"));a.listen("0.0.0.0",2e3,()=>console.log("Listening on 2000"));process.on("SIGINT",async()=>{await a.close(1e3),process.exit(0)});
